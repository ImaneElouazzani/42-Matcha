{"ast":null,"code":"import { forwardRef, useRef, createElement, useContext, useCallback, useEffect, useMemo, Fragment, useState, useReducer } from 'react';\nimport PropTypes from 'prop-types';\nimport { useIsomorphicLayoutEffect } from '@reach/utils/use-isomorphic-layout-effect';\nimport { getOwnerDocument } from '@reach/utils/owner-document';\nimport { createNamedContext } from '@reach/utils/context';\nimport { isFunction } from '@reach/utils/type-check';\nimport { makeId } from '@reach/utils/make-id';\nimport { noop } from '@reach/utils/noop';\nimport { useCheckStyles } from '@reach/utils/dev-utils';\nimport { useComposedRefs } from '@reach/utils/compose-refs';\nimport { useLazyRef } from '@reach/utils/use-lazy-ref';\nimport { useUpdateEffect } from '@reach/utils/use-update-effect';\nimport { composeEventHandlers } from '@reach/utils/compose-event-handlers';\nimport { createDescendantContext, useDescendantsInit, DescendantProvider, useDescendant, useDescendants } from '@reach/descendants';\nimport { useId } from '@reach/auto-id';\nimport { Popover, positionMatchWidth } from '@reach/popover';\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n} // Forked from https://github.com/bvaughn/highlight-words-core\n\n/**\n * Creates an array of chunk objects representing both higlightable and non\n * highlightable pieces of text that match each search word.\n *\n * @return Array of \"chunk\" objects\n */\n\n\nfunction findAll(_ref) {\n  var autoEscape = _ref.autoEscape,\n      _ref$caseSensitive = _ref.caseSensitive,\n      caseSensitive = _ref$caseSensitive === void 0 ? false : _ref$caseSensitive,\n      _ref$findChunks = _ref.findChunks,\n      findChunks = _ref$findChunks === void 0 ? defaultFindChunks : _ref$findChunks,\n      sanitize = _ref.sanitize,\n      searchWords = _ref.searchWords,\n      textToHighlight = _ref.textToHighlight;\n  return fillInChunks({\n    chunksToHighlight: combineChunks({\n      chunks: findChunks({\n        autoEscape: autoEscape,\n        caseSensitive: caseSensitive,\n        sanitize: sanitize,\n        searchWords: searchWords,\n        textToHighlight: textToHighlight\n      })\n    }),\n    totalLength: textToHighlight ? textToHighlight.length : 0\n  });\n}\n/**\n * Takes an array of \"chunk\" objects and combines chunks that overlap into\n * single chunks.\n *\n * @return Array of \"chunk\" objects\n */\n\n\nfunction combineChunks(_ref2) {\n  var chunks = _ref2.chunks;\n  return chunks.sort(function (first, second) {\n    return first.start - second.start;\n  }).reduce(function (processedChunks, nextChunk) {\n    // First chunk just goes straight in the array...\n    if (processedChunks.length === 0) {\n      return [nextChunk];\n    } else {\n      // ... subsequent chunks get checked to see if they overlap...\n      var prevChunk = processedChunks.pop();\n\n      if (nextChunk.start <= prevChunk.end) {\n        // It may be the case that prevChunk completely surrounds nextChunk, so take the\n        // largest of the end indeces.\n        var endIndex = Math.max(prevChunk.end, nextChunk.end);\n        processedChunks.push({\n          highlight: false,\n          start: prevChunk.start,\n          end: endIndex\n        });\n      } else {\n        processedChunks.push(prevChunk, nextChunk);\n      }\n\n      return processedChunks;\n    }\n  }, []);\n}\n/**\n * Examine text for any matches. If we find matches, add them to the returned\n * array as a \"chunk\" object.\n *\n * @return Array of \"chunk\" objects\n */\n\n\nfunction defaultFindChunks(_ref3) {\n  var autoEscape = _ref3.autoEscape,\n      caseSensitive = _ref3.caseSensitive,\n      _ref3$sanitize = _ref3.sanitize,\n      sanitize = _ref3$sanitize === void 0 ? defaultSanitize : _ref3$sanitize,\n      searchWords = _ref3.searchWords,\n      textToHighlight = _ref3.textToHighlight;\n  textToHighlight = sanitize(textToHighlight || \"\");\n  return searchWords.filter(function (searchWord) {\n    return searchWord;\n  }) // Remove empty words\n  .reduce(function (chunks, searchWord) {\n    searchWord = sanitize(searchWord);\n\n    if (autoEscape) {\n      searchWord = escapeRegExpFn(searchWord);\n    }\n\n    var regex = new RegExp(searchWord, caseSensitive ? \"g\" : \"gi\");\n    var match;\n\n    while (match = regex.exec(textToHighlight || \"\")) {\n      var start = match.index;\n      var end = regex.lastIndex; // We do not return zero-length matches\n\n      if (end > start) {\n        chunks.push({\n          highlight: false,\n          start: start,\n          end: end\n        });\n      } // Prevent browsers like Firefox from getting stuck in an infinite loop\n      // See http://www.regexguru.com/2008/04/watch-out-for-zero-length-matches/\n\n\n      if (match.index === regex.lastIndex) {\n        regex.lastIndex++;\n      }\n    }\n\n    return chunks;\n  }, []);\n}\n/**\n * Given a set of chunks to highlight, create an additional set of chunks\n * to represent the bits of text between the highlighted text.\n *\n * @return Array of \"chunk\" objects\n */\n\n\nfunction fillInChunks(_ref4) {\n  var chunksToHighlight = _ref4.chunksToHighlight,\n      totalLength = _ref4.totalLength;\n  var allChunks = [];\n\n  if (chunksToHighlight.length === 0) {\n    append(0, totalLength, false);\n  } else {\n    var lastIndex = 0;\n    chunksToHighlight.forEach(function (chunk) {\n      append(lastIndex, chunk.start, false);\n      append(chunk.start, chunk.end, true);\n      lastIndex = chunk.end;\n    });\n    append(lastIndex, totalLength, false);\n  }\n\n  return allChunks;\n\n  function append(start, end, highlight) {\n    if (end - start > 0) {\n      allChunks.push({\n        start: start,\n        end: end,\n        highlight: highlight\n      });\n    }\n  }\n}\n\nfunction defaultSanitize(string) {\n  return string;\n}\n\nfunction escapeRegExpFn(string) {\n  return string.replace(/[-[\\]/{}()*+?.\\\\^$|]/g, \"\\\\$&\");\n}\n\nvar HighlightWords = {\n  combineChunks: combineChunks,\n  fillInChunks: fillInChunks,\n  findAll: findAll,\n  findChunks: defaultFindChunks\n};\n\nvar _on, _on2, _on3, _on4, _states; ////////////////////////////////////////////////////////////////////////////////\n// States\n// Nothing going on, waiting for the user to type or use the arrow keys\n\n\nvar IDLE = \"IDLE\"; // The component is suggesting options as the user types\n\nvar SUGGESTING = \"SUGGESTING\"; // The user is using the keyboard to navigate the list, not typing\n\nvar NAVIGATING = \"NAVIGATING\"; // The user is interacting with arbitrary elements inside the popup that\n// are not ComboboxInputs\n\nvar INTERACTING = \"INTERACTING\"; ////////////////////////////////////////////////////////////////////////////////\n// Events\n// User cleared the value w/ backspace, but input still has focus\n\nvar CLEAR = \"CLEAR\"; // User is typing\n\nvar CHANGE = \"CHANGE\"; // Initial input value change handler for syncing user state with state machine\n// Prevents initial change from sending the user to the NAVIGATING state\n// https://github.com/reach/reach-ui/issues/464\n\nvar INITIAL_CHANGE = \"INITIAL_CHANGE\"; // User is navigating w/ the keyboard\n\nvar NAVIGATE = \"NAVIGATE\"; // User can be navigating with keyboard and then click instead, we want the\n// value from the click, not the current nav item\n\nvar SELECT_WITH_KEYBOARD = \"SELECT_WITH_KEYBOARD\";\nvar SELECT_WITH_CLICK = \"SELECT_WITH_CLICK\"; // Pretty self-explanatory, user can hit escape or blur to close the popover\n\nvar ESCAPE = \"ESCAPE\";\nvar BLUR = \"BLUR\"; // The user left the input to interact with arbitrary elements inside the popup\n\nvar INTERACT = \"INTERACT\";\nvar FOCUS = \"FOCUS\";\nvar OPEN_WITH_BUTTON = \"OPEN_WITH_BUTTON\";\nvar CLOSE_WITH_BUTTON = \"CLOSE_WITH_BUTTON\"; ////////////////////////////////////////////////////////////////////////////////\n\nvar stateChart = {\n  initial: IDLE,\n  states: (_states = {}, _states[IDLE] = {\n    on: (_on = {}, _on[BLUR] = IDLE, _on[CLEAR] = IDLE, _on[CHANGE] = SUGGESTING, _on[INITIAL_CHANGE] = IDLE, _on[FOCUS] = SUGGESTING, _on[NAVIGATE] = NAVIGATING, _on[OPEN_WITH_BUTTON] = SUGGESTING, _on)\n  }, _states[SUGGESTING] = {\n    on: (_on2 = {}, _on2[CHANGE] = SUGGESTING, _on2[FOCUS] = SUGGESTING, _on2[NAVIGATE] = NAVIGATING, _on2[CLEAR] = IDLE, _on2[ESCAPE] = IDLE, _on2[BLUR] = IDLE, _on2[SELECT_WITH_CLICK] = IDLE, _on2[INTERACT] = INTERACTING, _on2[CLOSE_WITH_BUTTON] = IDLE, _on2)\n  }, _states[NAVIGATING] = {\n    on: (_on3 = {}, _on3[CHANGE] = SUGGESTING, _on3[FOCUS] = SUGGESTING, _on3[CLEAR] = IDLE, _on3[BLUR] = IDLE, _on3[ESCAPE] = IDLE, _on3[NAVIGATE] = NAVIGATING, _on3[SELECT_WITH_CLICK] = IDLE, _on3[SELECT_WITH_KEYBOARD] = IDLE, _on3[CLOSE_WITH_BUTTON] = IDLE, _on3[INTERACT] = INTERACTING, _on3)\n  }, _states[INTERACTING] = {\n    on: (_on4 = {}, _on4[CLEAR] = IDLE, _on4[CHANGE] = SUGGESTING, _on4[FOCUS] = SUGGESTING, _on4[BLUR] = IDLE, _on4[ESCAPE] = IDLE, _on4[NAVIGATE] = NAVIGATING, _on4[CLOSE_WITH_BUTTON] = IDLE, _on4[SELECT_WITH_CLICK] = IDLE, _on4)\n  }, _states)\n};\n\nvar reducer = function reducer(data, event) {\n  var nextState = _extends({}, data, {\n    lastEventType: event.type\n  });\n\n  switch (event.type) {\n    case CHANGE:\n    case INITIAL_CHANGE:\n      return _extends({}, nextState, {\n        navigationValue: null,\n        value: event.value\n      });\n\n    case NAVIGATE:\n    case OPEN_WITH_BUTTON:\n      return _extends({}, nextState, {\n        navigationValue: findNavigationValue(nextState, event)\n      });\n\n    case CLEAR:\n      return _extends({}, nextState, {\n        value: \"\",\n        navigationValue: null\n      });\n\n    case BLUR:\n    case ESCAPE:\n      return _extends({}, nextState, {\n        navigationValue: null\n      });\n\n    case SELECT_WITH_CLICK:\n      return _extends({}, nextState, {\n        value: event.value,\n        navigationValue: null\n      });\n\n    case SELECT_WITH_KEYBOARD:\n      return _extends({}, nextState, {\n        value: data.navigationValue,\n        navigationValue: null\n      });\n\n    case CLOSE_WITH_BUTTON:\n      return _extends({}, nextState, {\n        navigationValue: null\n      });\n\n    case INTERACT:\n      return nextState;\n\n    case FOCUS:\n      return _extends({}, nextState, {\n        navigationValue: findNavigationValue(nextState, event)\n      });\n\n    default:\n      return nextState;\n  }\n};\n\nfunction popoverIsExpanded(state) {\n  return [SUGGESTING, NAVIGATING, INTERACTING].includes(state);\n}\n/**\n * When we open a list, set the navigation value to the value in the input, if\n * it's in the list, then it'll automatically be highlighted.\n *\n * @param stateData\n * @param event\n */\n\n\nfunction findNavigationValue(stateData, event) {\n  // @ts-ignore\n  if (event.value) {\n    // @ts-ignore\n    return event.value; // @ts-ignore\n  } else if (event.persistSelection) {\n    return stateData.value;\n  } else {\n    return null;\n  }\n}\n\nvar ComboboxDescendantContext = /*#__PURE__*/createDescendantContext(\"ComboboxDescendantContext\");\nvar ComboboxContext = /*#__PURE__*/createNamedContext(\"ComboboxContext\", {}); // Allows us to put the option's value on context so that ComboboxOptionText\n// can work it's highlight text magic no matter what else is rendered around\n// it.\n\nvar OptionContext = /*#__PURE__*/createNamedContext(\"OptionContext\", {}); ////////////////////////////////////////////////////////////////////////////////\n\n/**\n * Combobox\n *\n * @see Docs https://reach.tech/combobox#combobox\n */\n\nvar Combobox = /*#__PURE__*/forwardRef(function Combobox(_ref, forwardedRef) {\n  var _data$navigationValue;\n\n  var onSelect = _ref.onSelect,\n      _ref$openOnFocus = _ref.openOnFocus,\n      openOnFocus = _ref$openOnFocus === void 0 ? false : _ref$openOnFocus,\n      children = _ref.children,\n      _ref$as = _ref.as,\n      Comp = _ref$as === void 0 ? \"div\" : _ref$as,\n      ariaLabel = _ref[\"aria-label\"],\n      ariaLabelledby = _ref[\"aria-labelledby\"],\n      props = _objectWithoutPropertiesLoose(_ref, [\"onSelect\", \"openOnFocus\", \"children\", \"as\", \"aria-label\", \"aria-labelledby\"]);\n\n  var _useDescendantsInit = useDescendantsInit(),\n      options = _useDescendantsInit[0],\n      setOptions = _useDescendantsInit[1]; // Need this to focus it\n\n\n  var inputRef = useRef();\n  var popoverRef = useRef();\n  var buttonRef = useRef(); // When <ComboboxInput autocomplete={false} /> we don't want cycle back to\n  // the user's value while navigating (because it's always the user's value),\n  // but we need to know this in useKeyDown which is far away from the prop\n  // here, so we do something sneaky and write it to this ref on context so we\n  // can use it anywhere else üòõ. Another new trick for me and I'm excited\n  // about this one too!\n\n  var autocompletePropRef = useRef();\n  var persistSelectionRef = useRef();\n  var defaultData = {\n    // The value the user has typed. We derive this also when the developer is\n    // controlling the value of ComboboxInput.\n    value: \"\",\n    // the value the user has navigated to with the keyboard\n    navigationValue: null\n  };\n\n  var _useReducerMachine = useReducerMachine(stateChart, reducer, defaultData),\n      state = _useReducerMachine[0],\n      data = _useReducerMachine[1],\n      transition = _useReducerMachine[2];\n\n  useFocusManagement(data.lastEventType, inputRef);\n  var id = useId(props.id);\n  var listboxId = id ? makeId(\"listbox\", id) : \"listbox\";\n  var context = {\n    ariaLabel: ariaLabel,\n    ariaLabelledby: ariaLabelledby,\n    autocompletePropRef: autocompletePropRef,\n    buttonRef: buttonRef,\n    comboboxId: id,\n    data: data,\n    inputRef: inputRef,\n    isExpanded: popoverIsExpanded(state),\n    listboxId: listboxId,\n    onSelect: onSelect || noop,\n    openOnFocus: openOnFocus,\n    persistSelectionRef: persistSelectionRef,\n    popoverRef: popoverRef,\n    state: state,\n    transition: transition\n  };\n  useCheckStyles(\"combobox\");\n  return /*#__PURE__*/createElement(DescendantProvider, {\n    context: ComboboxDescendantContext,\n    items: options,\n    set: setOptions\n  }, /*#__PURE__*/createElement(ComboboxContext.Provider, {\n    value: context\n  }, /*#__PURE__*/createElement(Comp, _extends({}, props, {\n    \"data-reach-combobox\": \"\",\n    \"data-state\": getDataState(state),\n    ref: forwardedRef\n  }), isFunction(children) ? children({\n    id: id,\n    isExpanded: popoverIsExpanded(state),\n    navigationValue: (_data$navigationValue = data.navigationValue) != null ? _data$navigationValue : null,\n    state: state\n  }) : children)));\n});\n/**\n * @see Docs https://reach.tech/combobox#combobox-props\n */\n\nif (process.env.NODE_ENV !== \"production\") {\n  Combobox.displayName = \"Combobox\";\n  Combobox.propTypes = {\n    as: PropTypes.any,\n    onSelect: PropTypes.func,\n    openOnFocus: PropTypes.bool\n  };\n} ////////////////////////////////////////////////////////////////////////////////\n\n/**\n * ComboboxInput\n *\n * Wraps an `<input/>` with a couple extra props that work with the combobox.\n *\n * @see Docs https://reach.tech/combobox#comboboxinput\n */\n\n\nvar ComboboxInput = /*#__PURE__*/forwardRef(function ComboboxInput(_ref2, forwardedRef) {\n  var _ref2$as = _ref2.as,\n      Comp = _ref2$as === void 0 ? \"input\" : _ref2$as,\n      _ref2$selectOnClick = _ref2.selectOnClick,\n      selectOnClick = _ref2$selectOnClick === void 0 ? false : _ref2$selectOnClick,\n      _ref2$autocomplete = _ref2.autocomplete,\n      autocomplete = _ref2$autocomplete === void 0 ? true : _ref2$autocomplete,\n      onClick = _ref2.onClick,\n      onChange = _ref2.onChange,\n      onKeyDown = _ref2.onKeyDown,\n      onBlur = _ref2.onBlur,\n      onFocus = _ref2.onFocus,\n      controlledValue = _ref2.value,\n      props = _objectWithoutPropertiesLoose(_ref2, [\"as\", \"selectOnClick\", \"autocomplete\", \"onClick\", \"onChange\", \"onKeyDown\", \"onBlur\", \"onFocus\", \"value\"]); // https://github.com/reach/reach-ui/issues/464\n\n\n  var _React$useRef = useRef(controlledValue),\n      initialControlledValue = _React$useRef.current;\n\n  var controlledValueChangedRef = useRef(false);\n  useUpdateEffect(function () {\n    controlledValueChangedRef.current = true;\n  }, [controlledValue]);\n\n  var _React$useContext = useContext(ComboboxContext),\n      _React$useContext$dat = _React$useContext.data,\n      navigationValue = _React$useContext$dat.navigationValue,\n      value = _React$useContext$dat.value,\n      lastEventType = _React$useContext$dat.lastEventType,\n      inputRef = _React$useContext.inputRef,\n      state = _React$useContext.state,\n      transition = _React$useContext.transition,\n      listboxId = _React$useContext.listboxId,\n      autocompletePropRef = _React$useContext.autocompletePropRef,\n      openOnFocus = _React$useContext.openOnFocus,\n      isExpanded = _React$useContext.isExpanded,\n      ariaLabel = _React$useContext.ariaLabel,\n      ariaLabelledby = _React$useContext.ariaLabelledby,\n      persistSelectionRef = _React$useContext.persistSelectionRef;\n\n  var ref = useComposedRefs(inputRef, forwardedRef); // Because we close the List on blur, we need to track if the blur is\n  // caused by clicking inside the list, and if so, don't close the List.\n\n  var selectOnClickRef = useRef(false);\n  var handleKeyDown = useKeyDown();\n  var handleBlur = useBlur();\n  var isControlled = controlledValue != null; // Layout effect should be SSR-safe here because we don't actually do\n  // anything with this ref that involves rendering until after we've\n  // let the client hydrate in nested components.\n\n  useIsomorphicLayoutEffect(function () {\n    autocompletePropRef.current = autocomplete;\n  }, [autocomplete, autocompletePropRef]);\n  var handleValueChange = useCallback(function (value) {\n    if (value.trim() === \"\") {\n      transition(CLEAR);\n    } else if (value === initialControlledValue && !controlledValueChangedRef.current) {\n      transition(INITIAL_CHANGE, {\n        value: value\n      });\n    } else {\n      transition(CHANGE, {\n        value: value\n      });\n    }\n  }, [initialControlledValue, transition]);\n  useEffect(function () {\n    // If they are controlling the value we still need to do our transitions,\n    // so  we have this derived state to emulate onChange of the input as we\n    // receive new `value`s ...[*]\n    if (isControlled && controlledValue !== value && ( // https://github.com/reach/reach-ui/issues/481\n    controlledValue.trim() === \"\" ? (value || \"\").trim() !== \"\" : true)) {\n      handleValueChange(controlledValue);\n    }\n  }, [controlledValue, handleValueChange, isControlled, value]); // [*]... and when controlled, we don't trigger handleValueChange as the\n  // user types, instead the developer controls it with the normal input\n  // onChange prop\n\n  function handleChange(event) {\n    var value = event.target.value;\n\n    if (!isControlled) {\n      handleValueChange(value);\n    }\n  }\n\n  function handleFocus() {\n    if (selectOnClick) {\n      selectOnClickRef.current = true;\n    } // If we select an option with click, useFocusManagement will focus the\n    // input, in those cases we don't want to cause the menu to open back up,\n    // so we guard behind these states.\n\n\n    if (openOnFocus && lastEventType !== SELECT_WITH_CLICK) {\n      transition(FOCUS, {\n        persistSelection: persistSelectionRef.current\n      });\n    }\n  }\n\n  function handleClick() {\n    if (selectOnClickRef.current) {\n      selectOnClickRef.current = false;\n      inputRef.current.select();\n    }\n  }\n\n  var inputValue = autocomplete && (state === NAVIGATING || state === INTERACTING) ? // When idle, we don't have a navigationValue on ArrowUp/Down\n  navigationValue || controlledValue || value : controlledValue || value;\n  return /*#__PURE__*/createElement(Comp, _extends({\n    \"aria-activedescendant\": navigationValue ? String(makeHash(navigationValue)) : undefined,\n    \"aria-autocomplete\": \"both\",\n    \"aria-controls\": listboxId,\n    \"aria-expanded\": isExpanded,\n    \"aria-haspopup\": \"listbox\",\n    \"aria-label\": ariaLabel,\n    \"aria-labelledby\": ariaLabel ? undefined : ariaLabelledby,\n    role: \"combobox\"\n  }, props, {\n    \"data-reach-combobox-input\": \"\",\n    \"data-state\": getDataState(state),\n    ref: ref,\n    onBlur: composeEventHandlers(onBlur, handleBlur),\n    onChange: composeEventHandlers(onChange, handleChange),\n    onClick: composeEventHandlers(onClick, handleClick),\n    onFocus: composeEventHandlers(onFocus, handleFocus),\n    onKeyDown: composeEventHandlers(onKeyDown, handleKeyDown),\n    value: inputValue || \"\"\n  }));\n});\n/**\n * @see Docs https://reach.tech/combobox#comboboxinput-props\n */\n\nif (process.env.NODE_ENV !== \"production\") {\n  ComboboxInput.displayName = \"ComboboxInput\";\n} ////////////////////////////////////////////////////////////////////////////////\n\n/**\n * ComboboxPopover\n *\n * Contains the popup that renders the list. Because some UI needs to render\n * more than the list in the popup, you need to render one of these around the\n * list. For example, maybe you want to render the number of results suggested.\n *\n * @see Docs https://reach.tech/combobox#comboboxpopover\n */\n\n\nvar ComboboxPopover = /*#__PURE__*/forwardRef(function ComboboxPopover(_ref3, forwardedRef) {\n  var _ref3$as = _ref3.as,\n      Comp = _ref3$as === void 0 ? \"div\" : _ref3$as,\n      children = _ref3.children,\n      _ref3$portal = _ref3.portal,\n      portal = _ref3$portal === void 0 ? true : _ref3$portal,\n      onKeyDown = _ref3.onKeyDown,\n      onBlur = _ref3.onBlur,\n      _ref3$position = _ref3.position,\n      position = _ref3$position === void 0 ? positionMatchWidth : _ref3$position,\n      props = _objectWithoutPropertiesLoose(_ref3, [\"as\", \"children\", \"portal\", \"onKeyDown\", \"onBlur\", \"position\"]);\n\n  var _React$useContext2 = useContext(ComboboxContext),\n      popoverRef = _React$useContext2.popoverRef,\n      inputRef = _React$useContext2.inputRef,\n      isExpanded = _React$useContext2.isExpanded,\n      state = _React$useContext2.state;\n\n  var ref = useComposedRefs(popoverRef, forwardedRef);\n  var handleKeyDown = useKeyDown();\n  var handleBlur = useBlur();\n  var sharedProps = {\n    \"data-reach-combobox-popover\": \"\",\n    \"data-state\": getDataState(state),\n    onKeyDown: composeEventHandlers(onKeyDown, handleKeyDown),\n    onBlur: composeEventHandlers(onBlur, handleBlur),\n    // Instead of conditionally rendering the popover we use the `hidden` prop\n    // because we don't want to unmount on close (from escape or onSelect).\n    // However, the developer can conditionally render the ComboboxPopover if\n    // they do want to cause mount/unmount based on the app's own data (like\n    // results.length or whatever).\n    hidden: !isExpanded,\n    tabIndex: -1,\n    children: children\n  };\n  return portal ? /*#__PURE__*/createElement(Popover, _extends({\n    as: Comp\n  }, props, {\n    ref: ref,\n    position: position,\n    targetRef: inputRef\n  }, sharedProps)) : /*#__PURE__*/createElement(Comp, _extends({\n    ref: ref\n  }, props, sharedProps));\n});\n\nif (process.env.NODE_ENV !== \"production\") {\n  ComboboxPopover.displayName = \"ComboboxPopover\";\n}\n/**\n * @see Docs https://reach.tech/combobox#comboboxpopover-props\n */\n////////////////////////////////////////////////////////////////////////////////\n\n/**\n * ComboboxList\n *\n * Contains the `ComboboxOption` elements and sets up the proper aria attributes\n * for the list.\n *\n * @see Docs https://reach.tech/combobox#comboboxlist\n */\n\n\nvar ComboboxList = /*#__PURE__*/forwardRef(function ComboboxList(_ref4, forwardedRef) {\n  var _ref4$persistSelectio = _ref4.persistSelection,\n      persistSelection = _ref4$persistSelectio === void 0 ? false : _ref4$persistSelectio,\n      _ref4$as = _ref4.as,\n      Comp = _ref4$as === void 0 ? \"ul\" : _ref4$as,\n      props = _objectWithoutPropertiesLoose(_ref4, [\"persistSelection\", \"as\"]);\n\n  var _React$useContext3 = useContext(ComboboxContext),\n      persistSelectionRef = _React$useContext3.persistSelectionRef,\n      listboxId = _React$useContext3.listboxId;\n\n  if (persistSelection) {\n    persistSelectionRef.current = true;\n  }\n\n  return /*#__PURE__*/createElement(Comp, _extends({\n    role: \"listbox\"\n  }, props, {\n    ref: forwardedRef,\n    \"data-reach-combobox-list\": \"\",\n    id: listboxId\n  }));\n});\n/**\n * @see Docs https://reach.tech/combobox#comboboxlist-props\n */\n\nif (process.env.NODE_ENV !== \"production\") {\n  ComboboxList.displayName = \"ComboboxList\";\n} ////////////////////////////////////////////////////////////////////////////////\n\n/**\n * ComboboxOption\n *\n * An option that is suggested to the user as they interact with the combobox.\n *\n * @see Docs https://reach.tech/combobox#comboboxoption\n */\n\n\nvar ComboboxOption = /*#__PURE__*/forwardRef(function ComboboxOption(_ref5, forwardedRef) {\n  var _ref5$as = _ref5.as,\n      Comp = _ref5$as === void 0 ? \"li\" : _ref5$as,\n      children = _ref5.children,\n      value = _ref5.value,\n      onClick = _ref5.onClick,\n      props = _objectWithoutPropertiesLoose(_ref5, [\"as\", \"children\", \"value\", \"onClick\"]);\n\n  var _React$useContext4 = useContext(ComboboxContext),\n      onSelect = _React$useContext4.onSelect,\n      navigationValue = _React$useContext4.data.navigationValue,\n      transition = _React$useContext4.transition;\n\n  var ownRef = useRef(null);\n  var ref = useComposedRefs(forwardedRef, ownRef);\n  var index = useDescendant({\n    element: ownRef.current,\n    value: value\n  }, ComboboxDescendantContext);\n  var isActive = navigationValue === value;\n\n  var handleClick = function handleClick() {\n    onSelect && onSelect(value);\n    transition(SELECT_WITH_CLICK, {\n      value: value\n    });\n  };\n\n  return /*#__PURE__*/createElement(OptionContext.Provider, {\n    value: {\n      value: value,\n      index: index\n    }\n  }, /*#__PURE__*/createElement(Comp, _extends({\n    \"aria-selected\": isActive,\n    role: \"option\"\n  }, props, {\n    \"data-reach-combobox-option\": \"\",\n    ref: ref,\n    id: String(makeHash(value)),\n    \"data-highlighted\": isActive ? \"\" : undefined // Without this the menu will close from `onBlur`, but with it the\n    // element can be `document.activeElement` and then our focus checks in\n    // onBlur will work as intended\n    ,\n    tabIndex: -1,\n    onClick: composeEventHandlers(onClick, handleClick)\n  }), children ? isFunction(children) ? children({\n    value: value,\n    index: index\n  }) : children : /*#__PURE__*/createElement(ComboboxOptionText, null)));\n});\n/**\n * @see Docs https://reach.tech/combobox#comboboxoption-props\n */\n\nif (process.env.NODE_ENV !== \"production\") {\n  ComboboxOption.displayName = \"ComboboxOption\";\n} ////////////////////////////////////////////////////////////////////////////////\n\n/**\n * ComboboxOptionText\n *\n * Renders the value of a `ComboboxOption` as text but with spans wrapping the\n * matching and non-matching segments of text.\n *\n * We don't forwardRef or spread props because we render multiple spans or null,\n * should be fine ü§ô\n *\n * @example\n *   <ComboboxOption value=\"Seattle\">\n *     üåß <ComboboxOptionText />\n *   </ComboboxOption>\n *\n * @see Docs https://reach.tech/combobox#comboboxoptiontext\n */\n\n\nfunction ComboboxOptionText() {\n  var _React$useContext5 = useContext(OptionContext),\n      value = _React$useContext5.value;\n\n  var _React$useContext6 = useContext(ComboboxContext),\n      contextValue = _React$useContext6.data.value;\n\n  var results = useMemo(function () {\n    return HighlightWords.findAll({\n      searchWords: escapeRegexp(contextValue || \"\").split(/\\s+/),\n      textToHighlight: value\n    });\n  }, [contextValue, value]);\n  return /*#__PURE__*/createElement(Fragment, null, results.length ? results.map(function (result, index) {\n    var str = value.slice(result.start, result.end);\n    return /*#__PURE__*/createElement(\"span\", {\n      key: index,\n      \"data-reach-combobox-option-text\": \"\",\n      \"data-user-value\": result.highlight ? true : undefined,\n      \"data-suggested-value\": result.highlight ? undefined : true\n    }, str);\n  }) : value);\n}\n\nif (process.env.NODE_ENV !== \"production\") {\n  ComboboxOptionText.displayName = \"ComboboxOptionText\";\n} ////////////////////////////////////////////////////////////////////////////////\n\n/**\n * ComboboxButton\n */\n\n\nvar ComboboxButton = /*#__PURE__*/forwardRef(function ComboboxButton(_ref6, forwardedRef) {\n  var _ref6$as = _ref6.as,\n      Comp = _ref6$as === void 0 ? \"button\" : _ref6$as,\n      onClick = _ref6.onClick,\n      onKeyDown = _ref6.onKeyDown,\n      props = _objectWithoutPropertiesLoose(_ref6, [\"as\", \"onClick\", \"onKeyDown\"]);\n\n  var _React$useContext7 = useContext(ComboboxContext),\n      transition = _React$useContext7.transition,\n      state = _React$useContext7.state,\n      buttonRef = _React$useContext7.buttonRef,\n      listboxId = _React$useContext7.listboxId,\n      isExpanded = _React$useContext7.isExpanded;\n\n  var ref = useComposedRefs(buttonRef, forwardedRef);\n  var handleKeyDown = useKeyDown();\n\n  var handleClick = function handleClick() {\n    if (state === IDLE) {\n      transition(OPEN_WITH_BUTTON);\n    } else {\n      transition(CLOSE_WITH_BUTTON);\n    }\n  };\n\n  return /*#__PURE__*/createElement(Comp, _extends({\n    \"aria-controls\": listboxId,\n    \"aria-haspopup\": \"listbox\",\n    \"aria-expanded\": isExpanded\n  }, props, {\n    \"data-reach-combobox-button\": \"\",\n    ref: ref,\n    onClick: composeEventHandlers(onClick, handleClick),\n    onKeyDown: composeEventHandlers(onKeyDown, handleKeyDown)\n  }));\n});\n\nif (process.env.NODE_ENV !== \"production\") {\n  ComboboxButton.displayName = \"ComboboxButton\";\n} ////////////////////////////////////////////////////////////////////////////////\n\n/**\n * Move focus back to the input if we start navigating w/ the\n * keyboard after focus has moved to any focusable content in\n * the popup.\n *\n * @param lastEventType\n * @param inputRef\n */\n\n\nfunction useFocusManagement(lastEventType, inputRef) {\n  // useLayoutEffect so that the cursor goes to the end of the input instead\n  // of awkwardly at the beginning, unclear to me why ü§∑‚Äç‚ôÇÔ∏è\n  //\n  // Should be safe to use here since we're just focusing an input.\n  useIsomorphicLayoutEffect(function () {\n    if (lastEventType === NAVIGATE || lastEventType === ESCAPE || lastEventType === SELECT_WITH_CLICK || lastEventType === OPEN_WITH_BUTTON) {\n      inputRef.current.focus();\n    }\n  }, [inputRef, lastEventType]);\n}\n/**\n * We want the same events when the input or the popup have focus (HOW COOL ARE\n * HOOKS BTW?) This is probably the hairiest piece but it's not bad.\n */\n\n\nfunction useKeyDown() {\n  var _React$useContext8 = useContext(ComboboxContext),\n      navigationValue = _React$useContext8.data.navigationValue,\n      onSelect = _React$useContext8.onSelect,\n      state = _React$useContext8.state,\n      transition = _React$useContext8.transition,\n      autocompletePropRef = _React$useContext8.autocompletePropRef,\n      persistSelectionRef = _React$useContext8.persistSelectionRef;\n\n  var options = useDescendants(ComboboxDescendantContext);\n  return function handleKeyDown(event) {\n    var index = options.findIndex(function (_ref7) {\n      var value = _ref7.value;\n      return value === navigationValue;\n    });\n\n    function getNextOption() {\n      var atBottom = index === options.length - 1;\n\n      if (atBottom) {\n        if (autocompletePropRef.current) {\n          // Go back to the value the user has typed because we are\n          // autocompleting and they need to be able to get back to what\n          // they had typed w/o having to backspace out.\n          return null;\n        } else {\n          // cycle through\n          return getFirstOption();\n        }\n      } else {\n        // Go to the next item in the list\n        return options[(index + 1) % options.length];\n      }\n    }\n\n    function getPreviousOption() {\n      var atTop = index === 0;\n\n      if (atTop) {\n        if (autocompletePropRef.current) {\n          // Go back to the value the user has typed because we are\n          // autocompleting and they need to be able to get back to what\n          // they had typed w/o having to backspace out.\n          return null;\n        } else {\n          // cycle through\n          return getLastOption();\n        }\n      } else if (index === -1) {\n        // displaying the user's value, so go select the last one\n        return getLastOption();\n      } else {\n        // normal case, select previous\n        return options[(index - 1 + options.length) % options.length];\n      }\n    }\n\n    function getFirstOption() {\n      return options[0];\n    }\n\n    function getLastOption() {\n      return options[options.length - 1];\n    }\n\n    switch (event.key) {\n      case \"ArrowDown\":\n        // Don't scroll the page\n        event.preventDefault();\n\n        if (!options || !options.length) {\n          return;\n        }\n\n        if (state === IDLE) {\n          // Opening a closed list\n          transition(NAVIGATE, {\n            persistSelection: persistSelectionRef.current\n          });\n        } else {\n          var next = getNextOption();\n          transition(NAVIGATE, {\n            value: next ? next.value : null\n          });\n        }\n\n        break;\n      // A lot of duplicate code with ArrowDown up next, I'm already over it.\n\n      case \"ArrowUp\":\n        // Don't scroll the page\n        event.preventDefault();\n\n        if (!options || options.length === 0) {\n          return;\n        }\n\n        if (state === IDLE) {\n          transition(NAVIGATE);\n        } else {\n          var prev = getPreviousOption();\n          transition(NAVIGATE, {\n            value: prev ? prev.value : null\n          });\n        }\n\n        break;\n\n      case \"Home\":\n      case \"PageUp\":\n        // Don't scroll the page\n        event.preventDefault();\n\n        if (!options || options.length === 0) {\n          return;\n        }\n\n        if (state === IDLE) {\n          transition(NAVIGATE);\n        } else {\n          transition(NAVIGATE, {\n            value: getFirstOption().value\n          });\n        }\n\n        break;\n\n      case \"End\":\n      case \"PageDown\":\n        // Don't scroll the page\n        event.preventDefault();\n\n        if (!options || options.length === 0) {\n          return;\n        }\n\n        if (state === IDLE) {\n          transition(NAVIGATE);\n        } else {\n          transition(NAVIGATE, {\n            value: getLastOption().value\n          });\n        }\n\n        break;\n\n      case \"Escape\":\n        if (state !== IDLE) {\n          transition(ESCAPE);\n        }\n\n        break;\n\n      case \"Enter\":\n        if (state === NAVIGATING && navigationValue !== null) {\n          // don't want to submit forms\n          event.preventDefault();\n          onSelect && onSelect(navigationValue);\n          transition(SELECT_WITH_KEYBOARD);\n        }\n\n        break;\n    }\n  };\n}\n\nfunction useBlur() {\n  var _React$useContext9 = useContext(ComboboxContext),\n      state = _React$useContext9.state,\n      transition = _React$useContext9.transition,\n      popoverRef = _React$useContext9.popoverRef,\n      inputRef = _React$useContext9.inputRef,\n      buttonRef = _React$useContext9.buttonRef;\n\n  var rafIds = useLazyRef(function () {\n    return new Set();\n  });\n  useEffect(function () {\n    return function () {\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n      rafIds.current.forEach(function (id) {\n        return cancelAnimationFrame(id);\n      });\n    };\n  }, [rafIds]);\n  return function handleBlur() {\n    var ownerDocument = getOwnerDocument(popoverRef.current);\n\n    if (!ownerDocument) {\n      return;\n    }\n\n    var rafId = requestAnimationFrame(function () {\n      // we on want to close only if focus propss outside the combobox\n      if (ownerDocument.activeElement !== inputRef.current && ownerDocument.activeElement !== buttonRef.current && popoverRef.current) {\n        if (popoverRef.current.contains(ownerDocument.activeElement)) {\n          // focus landed inside the combobox, keep it open\n          if (state !== INTERACTING) {\n            transition(INTERACT);\n          }\n        } else {\n          // focus landed outside the combobox, close it.\n          transition(BLUR);\n        }\n      }\n    });\n    rafIds.current.add(rafId);\n  };\n}\n/**\n * This manages transitions between states with a built in reducer to manage\n * the data that goes with those transitions.\n *\n * @param chart\n * @param reducer\n * @param initialData\n */\n\n\nfunction useReducerMachine(chart, reducer, initialData) {\n  var _React$useState = useState(chart.initial),\n      state = _React$useState[0],\n      setState = _React$useState[1];\n\n  var _React$useReducer = useReducer(reducer, initialData),\n      data = _React$useReducer[0],\n      dispatch = _React$useReducer[1];\n\n  var transition = function transition(event, payload) {\n    if (payload === void 0) {\n      payload = {};\n    }\n\n    var currentState = chart.states[state];\n    var nextState = currentState && currentState.on[event];\n\n    if (nextState) {\n      dispatch(_extends({\n        type: event,\n        state: state,\n        nextState: state\n      }, payload));\n      setState(nextState);\n      return;\n    }\n  };\n\n  return [state, data, transition];\n}\n/**\n * We don't want to track the active descendant with indexes because nothing is\n * more annoying in a combobox than having it change values RIGHT AS YOU HIT\n * ENTER. That only happens if you use the index as your data, rather than\n * *your data as your data*. We use this to generate a unique ID based on the\n * value of each item.  This function is short, sweet, and good enough‚Ñ¢ (I also\n * don't know how it works, tbqh)\n *\n * @see https://stackoverflow.com/questions/6122571/simple-non-secure-hash-function-for-javascript\n * @param str\n */\n\n\nfunction makeHash(str) {\n  var hash = 0;\n\n  if (str.length === 0) {\n    return hash;\n  }\n\n  for (var i = 0; i < str.length; i++) {\n    var _char = str.charCodeAt(i);\n\n    hash = (hash << 5) - hash + _char;\n    hash = hash & hash;\n  }\n\n  return hash;\n}\n\nfunction getDataState(state) {\n  return state.toLowerCase();\n}\n/**\n * Escape regexp special characters in `str`\n *\n * @see https://github.com/component/escape-regexp/blob/5ce923c1510c9802b3da972c90b6861dd2829b6b/index.js\n * @param str\n */\n\n\nfunction escapeRegexp(str) {\n  return String(str).replace(/([.*+?=^!:${}()|[\\]/\\\\])/g, \"\\\\$1\");\n} //////////////////////////\n//////////////////////////////////////////////////////\n\n/**\n * A hook that exposes data for a given `Combobox` component to its descendants.\n *\n * @see Docs https://reach.tech/combobox#usecomboboxcontext\n */\n\n\nfunction useComboboxContext() {\n  var _React$useContext10 = useContext(ComboboxContext),\n      isExpanded = _React$useContext10.isExpanded,\n      comboboxId = _React$useContext10.comboboxId,\n      data = _React$useContext10.data,\n      state = _React$useContext10.state;\n\n  var navigationValue = data.navigationValue;\n  return useMemo(function () {\n    return {\n      id: comboboxId,\n      isExpanded: isExpanded,\n      navigationValue: navigationValue != null ? navigationValue : null,\n      state: state\n    };\n  }, [comboboxId, isExpanded, navigationValue, state]);\n}\n/**\n * A hook that exposes data for a given `ComboboxOption` component to its descendants.\n *\n * @see Docs https://reach.tech/combobox#usecomboboxcontext\n */\n\n\nfunction useComboboxOptionContext() {\n  var _React$useContext11 = useContext(OptionContext),\n      value = _React$useContext11.value,\n      index = _React$useContext11.index;\n\n  return useMemo(function () {\n    return {\n      value: value,\n      index: index\n    };\n  }, [value, index]);\n} ////////////////////////////////////////////////////////////////////////////////\n// Well alright, you made it all the way here to like 1100 lines of code (geez,\n// what the heck?). Have a great day :D\n////////////////////////////////////////////////////////////////////////////////\n// Types\n\n\nexport { Combobox, ComboboxButton, ComboboxInput, ComboboxList, ComboboxOption, ComboboxOptionText, ComboboxPopover, escapeRegexp, useComboboxContext, useComboboxOptionContext };","map":{"version":3,"sources":["/Users/ielouazz/Desktop/Matchaa/client/node_modules/@reach/combobox/dist/reach-combobox.esm.js"],"names":["forwardRef","useRef","createElement","useContext","useCallback","useEffect","useMemo","Fragment","useState","useReducer","PropTypes","useIsomorphicLayoutEffect","getOwnerDocument","createNamedContext","isFunction","makeId","noop","useCheckStyles","useComposedRefs","useLazyRef","useUpdateEffect","composeEventHandlers","createDescendantContext","useDescendantsInit","DescendantProvider","useDescendant","useDescendants","useId","Popover","positionMatchWidth","_objectWithoutPropertiesLoose","source","excluded","target","sourceKeys","Object","keys","key","i","length","indexOf","_extends","assign","arguments","prototype","hasOwnProperty","call","apply","findAll","_ref","autoEscape","_ref$caseSensitive","caseSensitive","_ref$findChunks","findChunks","defaultFindChunks","sanitize","searchWords","textToHighlight","fillInChunks","chunksToHighlight","combineChunks","chunks","totalLength","_ref2","sort","first","second","start","reduce","processedChunks","nextChunk","prevChunk","pop","end","endIndex","Math","max","push","highlight","_ref3","_ref3$sanitize","defaultSanitize","filter","searchWord","escapeRegExpFn","regex","RegExp","match","exec","index","lastIndex","_ref4","allChunks","append","forEach","chunk","string","replace","HighlightWords","_on","_on2","_on3","_on4","_states","IDLE","SUGGESTING","NAVIGATING","INTERACTING","CLEAR","CHANGE","INITIAL_CHANGE","NAVIGATE","SELECT_WITH_KEYBOARD","SELECT_WITH_CLICK","ESCAPE","BLUR","INTERACT","FOCUS","OPEN_WITH_BUTTON","CLOSE_WITH_BUTTON","stateChart","initial","states","on","reducer","data","event","nextState","lastEventType","type","navigationValue","value","findNavigationValue","popoverIsExpanded","state","includes","stateData","persistSelection","ComboboxDescendantContext","ComboboxContext","OptionContext","Combobox","forwardedRef","_data$navigationValue","onSelect","_ref$openOnFocus","openOnFocus","children","_ref$as","as","Comp","ariaLabel","ariaLabelledby","props","_useDescendantsInit","options","setOptions","inputRef","popoverRef","buttonRef","autocompletePropRef","persistSelectionRef","defaultData","_useReducerMachine","useReducerMachine","transition","useFocusManagement","id","listboxId","context","comboboxId","isExpanded","items","set","Provider","getDataState","ref","process","env","NODE_ENV","displayName","propTypes","any","func","bool","ComboboxInput","_ref2$as","_ref2$selectOnClick","selectOnClick","_ref2$autocomplete","autocomplete","onClick","onChange","onKeyDown","onBlur","onFocus","controlledValue","_React$useRef","initialControlledValue","current","controlledValueChangedRef","_React$useContext","_React$useContext$dat","selectOnClickRef","handleKeyDown","useKeyDown","handleBlur","useBlur","isControlled","handleValueChange","trim","handleChange","handleFocus","handleClick","select","inputValue","String","makeHash","undefined","role","ComboboxPopover","_ref3$as","_ref3$portal","portal","_ref3$position","position","_React$useContext2","sharedProps","hidden","tabIndex","targetRef","ComboboxList","_ref4$persistSelectio","_ref4$as","_React$useContext3","ComboboxOption","_ref5","_ref5$as","_React$useContext4","ownRef","element","isActive","ComboboxOptionText","_React$useContext5","_React$useContext6","contextValue","results","escapeRegexp","split","map","result","str","slice","ComboboxButton","_ref6","_ref6$as","_React$useContext7","focus","_React$useContext8","findIndex","_ref7","getNextOption","atBottom","getFirstOption","getPreviousOption","atTop","getLastOption","preventDefault","next","prev","_React$useContext9","rafIds","Set","cancelAnimationFrame","ownerDocument","rafId","requestAnimationFrame","activeElement","contains","add","chart","initialData","_React$useState","setState","_React$useReducer","dispatch","payload","currentState","hash","_char","charCodeAt","toLowerCase","useComboboxContext","_React$useContext10","useComboboxOptionContext","_React$useContext11"],"mappings":"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","sourcesContent":["import { forwardRef, useRef, createElement, useContext, useCallback, useEffect, useMemo, Fragment, useState, useReducer } from 'react';\nimport PropTypes from 'prop-types';\nimport { useIsomorphicLayoutEffect } from '@reach/utils/use-isomorphic-layout-effect';\nimport { getOwnerDocument } from '@reach/utils/owner-document';\nimport { createNamedContext } from '@reach/utils/context';\nimport { isFunction } from '@reach/utils/type-check';\nimport { makeId } from '@reach/utils/make-id';\nimport { noop } from '@reach/utils/noop';\nimport { useCheckStyles } from '@reach/utils/dev-utils';\nimport { useComposedRefs } from '@reach/utils/compose-refs';\nimport { useLazyRef } from '@reach/utils/use-lazy-ref';\nimport { useUpdateEffect } from '@reach/utils/use-update-effect';\nimport { composeEventHandlers } from '@reach/utils/compose-event-handlers';\nimport { createDescendantContext, useDescendantsInit, DescendantProvider, useDescendant, useDescendants } from '@reach/descendants';\nimport { useId } from '@reach/auto-id';\nimport { Popover, positionMatchWidth } from '@reach/popover';\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\n// Forked from https://github.com/bvaughn/highlight-words-core\n\n/**\n * Creates an array of chunk objects representing both higlightable and non\n * highlightable pieces of text that match each search word.\n *\n * @return Array of \"chunk\" objects\n */\nfunction findAll(_ref) {\n  var autoEscape = _ref.autoEscape,\n      _ref$caseSensitive = _ref.caseSensitive,\n      caseSensitive = _ref$caseSensitive === void 0 ? false : _ref$caseSensitive,\n      _ref$findChunks = _ref.findChunks,\n      findChunks = _ref$findChunks === void 0 ? defaultFindChunks : _ref$findChunks,\n      sanitize = _ref.sanitize,\n      searchWords = _ref.searchWords,\n      textToHighlight = _ref.textToHighlight;\n  return fillInChunks({\n    chunksToHighlight: combineChunks({\n      chunks: findChunks({\n        autoEscape: autoEscape,\n        caseSensitive: caseSensitive,\n        sanitize: sanitize,\n        searchWords: searchWords,\n        textToHighlight: textToHighlight\n      })\n    }),\n    totalLength: textToHighlight ? textToHighlight.length : 0\n  });\n}\n/**\n * Takes an array of \"chunk\" objects and combines chunks that overlap into\n * single chunks.\n *\n * @return Array of \"chunk\" objects\n */\n\n\nfunction combineChunks(_ref2) {\n  var chunks = _ref2.chunks;\n  return chunks.sort(function (first, second) {\n    return first.start - second.start;\n  }).reduce(function (processedChunks, nextChunk) {\n    // First chunk just goes straight in the array...\n    if (processedChunks.length === 0) {\n      return [nextChunk];\n    } else {\n      // ... subsequent chunks get checked to see if they overlap...\n      var prevChunk = processedChunks.pop();\n\n      if (nextChunk.start <= prevChunk.end) {\n        // It may be the case that prevChunk completely surrounds nextChunk, so take the\n        // largest of the end indeces.\n        var endIndex = Math.max(prevChunk.end, nextChunk.end);\n        processedChunks.push({\n          highlight: false,\n          start: prevChunk.start,\n          end: endIndex\n        });\n      } else {\n        processedChunks.push(prevChunk, nextChunk);\n      }\n\n      return processedChunks;\n    }\n  }, []);\n}\n/**\n * Examine text for any matches. If we find matches, add them to the returned\n * array as a \"chunk\" object.\n *\n * @return Array of \"chunk\" objects\n */\n\n\nfunction defaultFindChunks(_ref3) {\n  var autoEscape = _ref3.autoEscape,\n      caseSensitive = _ref3.caseSensitive,\n      _ref3$sanitize = _ref3.sanitize,\n      sanitize = _ref3$sanitize === void 0 ? defaultSanitize : _ref3$sanitize,\n      searchWords = _ref3.searchWords,\n      textToHighlight = _ref3.textToHighlight;\n  textToHighlight = sanitize(textToHighlight || \"\");\n  return searchWords.filter(function (searchWord) {\n    return searchWord;\n  }) // Remove empty words\n  .reduce(function (chunks, searchWord) {\n    searchWord = sanitize(searchWord);\n\n    if (autoEscape) {\n      searchWord = escapeRegExpFn(searchWord);\n    }\n\n    var regex = new RegExp(searchWord, caseSensitive ? \"g\" : \"gi\");\n    var match;\n\n    while (match = regex.exec(textToHighlight || \"\")) {\n      var start = match.index;\n      var end = regex.lastIndex; // We do not return zero-length matches\n\n      if (end > start) {\n        chunks.push({\n          highlight: false,\n          start: start,\n          end: end\n        });\n      } // Prevent browsers like Firefox from getting stuck in an infinite loop\n      // See http://www.regexguru.com/2008/04/watch-out-for-zero-length-matches/\n\n\n      if (match.index === regex.lastIndex) {\n        regex.lastIndex++;\n      }\n    }\n\n    return chunks;\n  }, []);\n}\n/**\n * Given a set of chunks to highlight, create an additional set of chunks\n * to represent the bits of text between the highlighted text.\n *\n * @return Array of \"chunk\" objects\n */\n\n\nfunction fillInChunks(_ref4) {\n  var chunksToHighlight = _ref4.chunksToHighlight,\n      totalLength = _ref4.totalLength;\n  var allChunks = [];\n\n  if (chunksToHighlight.length === 0) {\n    append(0, totalLength, false);\n  } else {\n    var lastIndex = 0;\n    chunksToHighlight.forEach(function (chunk) {\n      append(lastIndex, chunk.start, false);\n      append(chunk.start, chunk.end, true);\n      lastIndex = chunk.end;\n    });\n    append(lastIndex, totalLength, false);\n  }\n\n  return allChunks;\n\n  function append(start, end, highlight) {\n    if (end - start > 0) {\n      allChunks.push({\n        start: start,\n        end: end,\n        highlight: highlight\n      });\n    }\n  }\n}\n\nfunction defaultSanitize(string) {\n  return string;\n}\n\nfunction escapeRegExpFn(string) {\n  return string.replace(/[-[\\]/{}()*+?.\\\\^$|]/g, \"\\\\$&\");\n}\n\nvar HighlightWords = {\n  combineChunks: combineChunks,\n  fillInChunks: fillInChunks,\n  findAll: findAll,\n  findChunks: defaultFindChunks\n};\n\nvar _on, _on2, _on3, _on4, _states;\n////////////////////////////////////////////////////////////////////////////////\n// States\n// Nothing going on, waiting for the user to type or use the arrow keys\nvar IDLE = \"IDLE\"; // The component is suggesting options as the user types\n\nvar SUGGESTING = \"SUGGESTING\"; // The user is using the keyboard to navigate the list, not typing\n\nvar NAVIGATING = \"NAVIGATING\"; // The user is interacting with arbitrary elements inside the popup that\n// are not ComboboxInputs\n\nvar INTERACTING = \"INTERACTING\"; ////////////////////////////////////////////////////////////////////////////////\n// Events\n// User cleared the value w/ backspace, but input still has focus\n\nvar CLEAR = \"CLEAR\"; // User is typing\n\nvar CHANGE = \"CHANGE\"; // Initial input value change handler for syncing user state with state machine\n// Prevents initial change from sending the user to the NAVIGATING state\n// https://github.com/reach/reach-ui/issues/464\n\nvar INITIAL_CHANGE = \"INITIAL_CHANGE\"; // User is navigating w/ the keyboard\n\nvar NAVIGATE = \"NAVIGATE\"; // User can be navigating with keyboard and then click instead, we want the\n// value from the click, not the current nav item\n\nvar SELECT_WITH_KEYBOARD = \"SELECT_WITH_KEYBOARD\";\nvar SELECT_WITH_CLICK = \"SELECT_WITH_CLICK\"; // Pretty self-explanatory, user can hit escape or blur to close the popover\n\nvar ESCAPE = \"ESCAPE\";\nvar BLUR = \"BLUR\"; // The user left the input to interact with arbitrary elements inside the popup\n\nvar INTERACT = \"INTERACT\";\nvar FOCUS = \"FOCUS\";\nvar OPEN_WITH_BUTTON = \"OPEN_WITH_BUTTON\";\nvar CLOSE_WITH_BUTTON = \"CLOSE_WITH_BUTTON\"; ////////////////////////////////////////////////////////////////////////////////\n\nvar stateChart = {\n  initial: IDLE,\n  states: (_states = {}, _states[IDLE] = {\n    on: (_on = {}, _on[BLUR] = IDLE, _on[CLEAR] = IDLE, _on[CHANGE] = SUGGESTING, _on[INITIAL_CHANGE] = IDLE, _on[FOCUS] = SUGGESTING, _on[NAVIGATE] = NAVIGATING, _on[OPEN_WITH_BUTTON] = SUGGESTING, _on)\n  }, _states[SUGGESTING] = {\n    on: (_on2 = {}, _on2[CHANGE] = SUGGESTING, _on2[FOCUS] = SUGGESTING, _on2[NAVIGATE] = NAVIGATING, _on2[CLEAR] = IDLE, _on2[ESCAPE] = IDLE, _on2[BLUR] = IDLE, _on2[SELECT_WITH_CLICK] = IDLE, _on2[INTERACT] = INTERACTING, _on2[CLOSE_WITH_BUTTON] = IDLE, _on2)\n  }, _states[NAVIGATING] = {\n    on: (_on3 = {}, _on3[CHANGE] = SUGGESTING, _on3[FOCUS] = SUGGESTING, _on3[CLEAR] = IDLE, _on3[BLUR] = IDLE, _on3[ESCAPE] = IDLE, _on3[NAVIGATE] = NAVIGATING, _on3[SELECT_WITH_CLICK] = IDLE, _on3[SELECT_WITH_KEYBOARD] = IDLE, _on3[CLOSE_WITH_BUTTON] = IDLE, _on3[INTERACT] = INTERACTING, _on3)\n  }, _states[INTERACTING] = {\n    on: (_on4 = {}, _on4[CLEAR] = IDLE, _on4[CHANGE] = SUGGESTING, _on4[FOCUS] = SUGGESTING, _on4[BLUR] = IDLE, _on4[ESCAPE] = IDLE, _on4[NAVIGATE] = NAVIGATING, _on4[CLOSE_WITH_BUTTON] = IDLE, _on4[SELECT_WITH_CLICK] = IDLE, _on4)\n  }, _states)\n};\n\nvar reducer = function reducer(data, event) {\n  var nextState = _extends({}, data, {\n    lastEventType: event.type\n  });\n\n  switch (event.type) {\n    case CHANGE:\n    case INITIAL_CHANGE:\n      return _extends({}, nextState, {\n        navigationValue: null,\n        value: event.value\n      });\n\n    case NAVIGATE:\n    case OPEN_WITH_BUTTON:\n      return _extends({}, nextState, {\n        navigationValue: findNavigationValue(nextState, event)\n      });\n\n    case CLEAR:\n      return _extends({}, nextState, {\n        value: \"\",\n        navigationValue: null\n      });\n\n    case BLUR:\n    case ESCAPE:\n      return _extends({}, nextState, {\n        navigationValue: null\n      });\n\n    case SELECT_WITH_CLICK:\n      return _extends({}, nextState, {\n        value: event.value,\n        navigationValue: null\n      });\n\n    case SELECT_WITH_KEYBOARD:\n      return _extends({}, nextState, {\n        value: data.navigationValue,\n        navigationValue: null\n      });\n\n    case CLOSE_WITH_BUTTON:\n      return _extends({}, nextState, {\n        navigationValue: null\n      });\n\n    case INTERACT:\n      return nextState;\n\n    case FOCUS:\n      return _extends({}, nextState, {\n        navigationValue: findNavigationValue(nextState, event)\n      });\n\n    default:\n      return nextState;\n  }\n};\n\nfunction popoverIsExpanded(state) {\n  return [SUGGESTING, NAVIGATING, INTERACTING].includes(state);\n}\n/**\n * When we open a list, set the navigation value to the value in the input, if\n * it's in the list, then it'll automatically be highlighted.\n *\n * @param stateData\n * @param event\n */\n\n\nfunction findNavigationValue(stateData, event) {\n  // @ts-ignore\n  if (event.value) {\n    // @ts-ignore\n    return event.value; // @ts-ignore\n  } else if (event.persistSelection) {\n    return stateData.value;\n  } else {\n    return null;\n  }\n}\n\nvar ComboboxDescendantContext = /*#__PURE__*/createDescendantContext(\"ComboboxDescendantContext\");\nvar ComboboxContext = /*#__PURE__*/createNamedContext(\"ComboboxContext\", {}); // Allows us to put the option's value on context so that ComboboxOptionText\n// can work it's highlight text magic no matter what else is rendered around\n// it.\n\nvar OptionContext = /*#__PURE__*/createNamedContext(\"OptionContext\", {}); ////////////////////////////////////////////////////////////////////////////////\n\n/**\n * Combobox\n *\n * @see Docs https://reach.tech/combobox#combobox\n */\n\nvar Combobox = /*#__PURE__*/forwardRef(function Combobox(_ref, forwardedRef) {\n  var _data$navigationValue;\n\n  var onSelect = _ref.onSelect,\n      _ref$openOnFocus = _ref.openOnFocus,\n      openOnFocus = _ref$openOnFocus === void 0 ? false : _ref$openOnFocus,\n      children = _ref.children,\n      _ref$as = _ref.as,\n      Comp = _ref$as === void 0 ? \"div\" : _ref$as,\n      ariaLabel = _ref[\"aria-label\"],\n      ariaLabelledby = _ref[\"aria-labelledby\"],\n      props = _objectWithoutPropertiesLoose(_ref, [\"onSelect\", \"openOnFocus\", \"children\", \"as\", \"aria-label\", \"aria-labelledby\"]);\n\n  var _useDescendantsInit = useDescendantsInit(),\n      options = _useDescendantsInit[0],\n      setOptions = _useDescendantsInit[1]; // Need this to focus it\n\n\n  var inputRef = useRef();\n  var popoverRef = useRef();\n  var buttonRef = useRef(); // When <ComboboxInput autocomplete={false} /> we don't want cycle back to\n  // the user's value while navigating (because it's always the user's value),\n  // but we need to know this in useKeyDown which is far away from the prop\n  // here, so we do something sneaky and write it to this ref on context so we\n  // can use it anywhere else üòõ. Another new trick for me and I'm excited\n  // about this one too!\n\n  var autocompletePropRef = useRef();\n  var persistSelectionRef = useRef();\n  var defaultData = {\n    // The value the user has typed. We derive this also when the developer is\n    // controlling the value of ComboboxInput.\n    value: \"\",\n    // the value the user has navigated to with the keyboard\n    navigationValue: null\n  };\n\n  var _useReducerMachine = useReducerMachine(stateChart, reducer, defaultData),\n      state = _useReducerMachine[0],\n      data = _useReducerMachine[1],\n      transition = _useReducerMachine[2];\n\n  useFocusManagement(data.lastEventType, inputRef);\n  var id = useId(props.id);\n  var listboxId = id ? makeId(\"listbox\", id) : \"listbox\";\n  var context = {\n    ariaLabel: ariaLabel,\n    ariaLabelledby: ariaLabelledby,\n    autocompletePropRef: autocompletePropRef,\n    buttonRef: buttonRef,\n    comboboxId: id,\n    data: data,\n    inputRef: inputRef,\n    isExpanded: popoverIsExpanded(state),\n    listboxId: listboxId,\n    onSelect: onSelect || noop,\n    openOnFocus: openOnFocus,\n    persistSelectionRef: persistSelectionRef,\n    popoverRef: popoverRef,\n    state: state,\n    transition: transition\n  };\n  useCheckStyles(\"combobox\");\n  return /*#__PURE__*/createElement(DescendantProvider, {\n    context: ComboboxDescendantContext,\n    items: options,\n    set: setOptions\n  }, /*#__PURE__*/createElement(ComboboxContext.Provider, {\n    value: context\n  }, /*#__PURE__*/createElement(Comp, _extends({}, props, {\n    \"data-reach-combobox\": \"\",\n    \"data-state\": getDataState(state),\n    ref: forwardedRef\n  }), isFunction(children) ? children({\n    id: id,\n    isExpanded: popoverIsExpanded(state),\n    navigationValue: (_data$navigationValue = data.navigationValue) != null ? _data$navigationValue : null,\n    state: state\n  }) : children)));\n});\n/**\n * @see Docs https://reach.tech/combobox#combobox-props\n */\n\nif (process.env.NODE_ENV !== \"production\") {\n  Combobox.displayName = \"Combobox\";\n  Combobox.propTypes = {\n    as: PropTypes.any,\n    onSelect: PropTypes.func,\n    openOnFocus: PropTypes.bool\n  };\n} ////////////////////////////////////////////////////////////////////////////////\n\n/**\n * ComboboxInput\n *\n * Wraps an `<input/>` with a couple extra props that work with the combobox.\n *\n * @see Docs https://reach.tech/combobox#comboboxinput\n */\n\n\nvar ComboboxInput = /*#__PURE__*/forwardRef(function ComboboxInput(_ref2, forwardedRef) {\n  var _ref2$as = _ref2.as,\n      Comp = _ref2$as === void 0 ? \"input\" : _ref2$as,\n      _ref2$selectOnClick = _ref2.selectOnClick,\n      selectOnClick = _ref2$selectOnClick === void 0 ? false : _ref2$selectOnClick,\n      _ref2$autocomplete = _ref2.autocomplete,\n      autocomplete = _ref2$autocomplete === void 0 ? true : _ref2$autocomplete,\n      onClick = _ref2.onClick,\n      onChange = _ref2.onChange,\n      onKeyDown = _ref2.onKeyDown,\n      onBlur = _ref2.onBlur,\n      onFocus = _ref2.onFocus,\n      controlledValue = _ref2.value,\n      props = _objectWithoutPropertiesLoose(_ref2, [\"as\", \"selectOnClick\", \"autocomplete\", \"onClick\", \"onChange\", \"onKeyDown\", \"onBlur\", \"onFocus\", \"value\"]);\n\n  // https://github.com/reach/reach-ui/issues/464\n  var _React$useRef = useRef(controlledValue),\n      initialControlledValue = _React$useRef.current;\n\n  var controlledValueChangedRef = useRef(false);\n  useUpdateEffect(function () {\n    controlledValueChangedRef.current = true;\n  }, [controlledValue]);\n\n  var _React$useContext = useContext(ComboboxContext),\n      _React$useContext$dat = _React$useContext.data,\n      navigationValue = _React$useContext$dat.navigationValue,\n      value = _React$useContext$dat.value,\n      lastEventType = _React$useContext$dat.lastEventType,\n      inputRef = _React$useContext.inputRef,\n      state = _React$useContext.state,\n      transition = _React$useContext.transition,\n      listboxId = _React$useContext.listboxId,\n      autocompletePropRef = _React$useContext.autocompletePropRef,\n      openOnFocus = _React$useContext.openOnFocus,\n      isExpanded = _React$useContext.isExpanded,\n      ariaLabel = _React$useContext.ariaLabel,\n      ariaLabelledby = _React$useContext.ariaLabelledby,\n      persistSelectionRef = _React$useContext.persistSelectionRef;\n\n  var ref = useComposedRefs(inputRef, forwardedRef); // Because we close the List on blur, we need to track if the blur is\n  // caused by clicking inside the list, and if so, don't close the List.\n\n  var selectOnClickRef = useRef(false);\n  var handleKeyDown = useKeyDown();\n  var handleBlur = useBlur();\n  var isControlled = controlledValue != null; // Layout effect should be SSR-safe here because we don't actually do\n  // anything with this ref that involves rendering until after we've\n  // let the client hydrate in nested components.\n\n  useIsomorphicLayoutEffect(function () {\n    autocompletePropRef.current = autocomplete;\n  }, [autocomplete, autocompletePropRef]);\n  var handleValueChange = useCallback(function (value) {\n    if (value.trim() === \"\") {\n      transition(CLEAR);\n    } else if (value === initialControlledValue && !controlledValueChangedRef.current) {\n      transition(INITIAL_CHANGE, {\n        value: value\n      });\n    } else {\n      transition(CHANGE, {\n        value: value\n      });\n    }\n  }, [initialControlledValue, transition]);\n  useEffect(function () {\n    // If they are controlling the value we still need to do our transitions,\n    // so  we have this derived state to emulate onChange of the input as we\n    // receive new `value`s ...[*]\n    if (isControlled && controlledValue !== value && ( // https://github.com/reach/reach-ui/issues/481\n    controlledValue.trim() === \"\" ? (value || \"\").trim() !== \"\" : true)) {\n      handleValueChange(controlledValue);\n    }\n  }, [controlledValue, handleValueChange, isControlled, value]); // [*]... and when controlled, we don't trigger handleValueChange as the\n  // user types, instead the developer controls it with the normal input\n  // onChange prop\n\n  function handleChange(event) {\n    var value = event.target.value;\n\n    if (!isControlled) {\n      handleValueChange(value);\n    }\n  }\n\n  function handleFocus() {\n    if (selectOnClick) {\n      selectOnClickRef.current = true;\n    } // If we select an option with click, useFocusManagement will focus the\n    // input, in those cases we don't want to cause the menu to open back up,\n    // so we guard behind these states.\n\n\n    if (openOnFocus && lastEventType !== SELECT_WITH_CLICK) {\n      transition(FOCUS, {\n        persistSelection: persistSelectionRef.current\n      });\n    }\n  }\n\n  function handleClick() {\n    if (selectOnClickRef.current) {\n      selectOnClickRef.current = false;\n      inputRef.current.select();\n    }\n  }\n\n  var inputValue = autocomplete && (state === NAVIGATING || state === INTERACTING) ? // When idle, we don't have a navigationValue on ArrowUp/Down\n  navigationValue || controlledValue || value : controlledValue || value;\n  return /*#__PURE__*/createElement(Comp, _extends({\n    \"aria-activedescendant\": navigationValue ? String(makeHash(navigationValue)) : undefined,\n    \"aria-autocomplete\": \"both\",\n    \"aria-controls\": listboxId,\n    \"aria-expanded\": isExpanded,\n    \"aria-haspopup\": \"listbox\",\n    \"aria-label\": ariaLabel,\n    \"aria-labelledby\": ariaLabel ? undefined : ariaLabelledby,\n    role: \"combobox\"\n  }, props, {\n    \"data-reach-combobox-input\": \"\",\n    \"data-state\": getDataState(state),\n    ref: ref,\n    onBlur: composeEventHandlers(onBlur, handleBlur),\n    onChange: composeEventHandlers(onChange, handleChange),\n    onClick: composeEventHandlers(onClick, handleClick),\n    onFocus: composeEventHandlers(onFocus, handleFocus),\n    onKeyDown: composeEventHandlers(onKeyDown, handleKeyDown),\n    value: inputValue || \"\"\n  }));\n});\n/**\n * @see Docs https://reach.tech/combobox#comboboxinput-props\n */\n\nif (process.env.NODE_ENV !== \"production\") {\n  ComboboxInput.displayName = \"ComboboxInput\";\n} ////////////////////////////////////////////////////////////////////////////////\n\n/**\n * ComboboxPopover\n *\n * Contains the popup that renders the list. Because some UI needs to render\n * more than the list in the popup, you need to render one of these around the\n * list. For example, maybe you want to render the number of results suggested.\n *\n * @see Docs https://reach.tech/combobox#comboboxpopover\n */\n\n\nvar ComboboxPopover = /*#__PURE__*/forwardRef(function ComboboxPopover(_ref3, forwardedRef) {\n  var _ref3$as = _ref3.as,\n      Comp = _ref3$as === void 0 ? \"div\" : _ref3$as,\n      children = _ref3.children,\n      _ref3$portal = _ref3.portal,\n      portal = _ref3$portal === void 0 ? true : _ref3$portal,\n      onKeyDown = _ref3.onKeyDown,\n      onBlur = _ref3.onBlur,\n      _ref3$position = _ref3.position,\n      position = _ref3$position === void 0 ? positionMatchWidth : _ref3$position,\n      props = _objectWithoutPropertiesLoose(_ref3, [\"as\", \"children\", \"portal\", \"onKeyDown\", \"onBlur\", \"position\"]);\n\n  var _React$useContext2 = useContext(ComboboxContext),\n      popoverRef = _React$useContext2.popoverRef,\n      inputRef = _React$useContext2.inputRef,\n      isExpanded = _React$useContext2.isExpanded,\n      state = _React$useContext2.state;\n\n  var ref = useComposedRefs(popoverRef, forwardedRef);\n  var handleKeyDown = useKeyDown();\n  var handleBlur = useBlur();\n  var sharedProps = {\n    \"data-reach-combobox-popover\": \"\",\n    \"data-state\": getDataState(state),\n    onKeyDown: composeEventHandlers(onKeyDown, handleKeyDown),\n    onBlur: composeEventHandlers(onBlur, handleBlur),\n    // Instead of conditionally rendering the popover we use the `hidden` prop\n    // because we don't want to unmount on close (from escape or onSelect).\n    // However, the developer can conditionally render the ComboboxPopover if\n    // they do want to cause mount/unmount based on the app's own data (like\n    // results.length or whatever).\n    hidden: !isExpanded,\n    tabIndex: -1,\n    children: children\n  };\n  return portal ? /*#__PURE__*/createElement(Popover, _extends({\n    as: Comp\n  }, props, {\n    ref: ref,\n    position: position,\n    targetRef: inputRef\n  }, sharedProps)) : /*#__PURE__*/createElement(Comp, _extends({\n    ref: ref\n  }, props, sharedProps));\n});\n\nif (process.env.NODE_ENV !== \"production\") {\n  ComboboxPopover.displayName = \"ComboboxPopover\";\n}\n/**\n * @see Docs https://reach.tech/combobox#comboboxpopover-props\n */\n\n\n////////////////////////////////////////////////////////////////////////////////\n\n/**\n * ComboboxList\n *\n * Contains the `ComboboxOption` elements and sets up the proper aria attributes\n * for the list.\n *\n * @see Docs https://reach.tech/combobox#comboboxlist\n */\nvar ComboboxList = /*#__PURE__*/forwardRef(function ComboboxList(_ref4, forwardedRef) {\n  var _ref4$persistSelectio = _ref4.persistSelection,\n      persistSelection = _ref4$persistSelectio === void 0 ? false : _ref4$persistSelectio,\n      _ref4$as = _ref4.as,\n      Comp = _ref4$as === void 0 ? \"ul\" : _ref4$as,\n      props = _objectWithoutPropertiesLoose(_ref4, [\"persistSelection\", \"as\"]);\n\n  var _React$useContext3 = useContext(ComboboxContext),\n      persistSelectionRef = _React$useContext3.persistSelectionRef,\n      listboxId = _React$useContext3.listboxId;\n\n  if (persistSelection) {\n    persistSelectionRef.current = true;\n  }\n\n  return /*#__PURE__*/createElement(Comp, _extends({\n    role: \"listbox\"\n  }, props, {\n    ref: forwardedRef,\n    \"data-reach-combobox-list\": \"\",\n    id: listboxId\n  }));\n});\n/**\n * @see Docs https://reach.tech/combobox#comboboxlist-props\n */\n\nif (process.env.NODE_ENV !== \"production\") {\n  ComboboxList.displayName = \"ComboboxList\";\n} ////////////////////////////////////////////////////////////////////////////////\n\n/**\n * ComboboxOption\n *\n * An option that is suggested to the user as they interact with the combobox.\n *\n * @see Docs https://reach.tech/combobox#comboboxoption\n */\n\n\nvar ComboboxOption = /*#__PURE__*/forwardRef(function ComboboxOption(_ref5, forwardedRef) {\n  var _ref5$as = _ref5.as,\n      Comp = _ref5$as === void 0 ? \"li\" : _ref5$as,\n      children = _ref5.children,\n      value = _ref5.value,\n      onClick = _ref5.onClick,\n      props = _objectWithoutPropertiesLoose(_ref5, [\"as\", \"children\", \"value\", \"onClick\"]);\n\n  var _React$useContext4 = useContext(ComboboxContext),\n      onSelect = _React$useContext4.onSelect,\n      navigationValue = _React$useContext4.data.navigationValue,\n      transition = _React$useContext4.transition;\n\n  var ownRef = useRef(null);\n  var ref = useComposedRefs(forwardedRef, ownRef);\n  var index = useDescendant({\n    element: ownRef.current,\n    value: value\n  }, ComboboxDescendantContext);\n  var isActive = navigationValue === value;\n\n  var handleClick = function handleClick() {\n    onSelect && onSelect(value);\n    transition(SELECT_WITH_CLICK, {\n      value: value\n    });\n  };\n\n  return /*#__PURE__*/createElement(OptionContext.Provider, {\n    value: {\n      value: value,\n      index: index\n    }\n  }, /*#__PURE__*/createElement(Comp, _extends({\n    \"aria-selected\": isActive,\n    role: \"option\"\n  }, props, {\n    \"data-reach-combobox-option\": \"\",\n    ref: ref,\n    id: String(makeHash(value)),\n    \"data-highlighted\": isActive ? \"\" : undefined // Without this the menu will close from `onBlur`, but with it the\n    // element can be `document.activeElement` and then our focus checks in\n    // onBlur will work as intended\n    ,\n    tabIndex: -1,\n    onClick: composeEventHandlers(onClick, handleClick)\n  }), children ? isFunction(children) ? children({\n    value: value,\n    index: index\n  }) : children : /*#__PURE__*/createElement(ComboboxOptionText, null)));\n});\n/**\n * @see Docs https://reach.tech/combobox#comboboxoption-props\n */\n\nif (process.env.NODE_ENV !== \"production\") {\n  ComboboxOption.displayName = \"ComboboxOption\";\n} ////////////////////////////////////////////////////////////////////////////////\n\n/**\n * ComboboxOptionText\n *\n * Renders the value of a `ComboboxOption` as text but with spans wrapping the\n * matching and non-matching segments of text.\n *\n * We don't forwardRef or spread props because we render multiple spans or null,\n * should be fine ü§ô\n *\n * @example\n *   <ComboboxOption value=\"Seattle\">\n *     üåß <ComboboxOptionText />\n *   </ComboboxOption>\n *\n * @see Docs https://reach.tech/combobox#comboboxoptiontext\n */\n\n\nfunction ComboboxOptionText() {\n  var _React$useContext5 = useContext(OptionContext),\n      value = _React$useContext5.value;\n\n  var _React$useContext6 = useContext(ComboboxContext),\n      contextValue = _React$useContext6.data.value;\n\n  var results = useMemo(function () {\n    return HighlightWords.findAll({\n      searchWords: escapeRegexp(contextValue || \"\").split(/\\s+/),\n      textToHighlight: value\n    });\n  }, [contextValue, value]);\n  return /*#__PURE__*/createElement(Fragment, null, results.length ? results.map(function (result, index) {\n    var str = value.slice(result.start, result.end);\n    return /*#__PURE__*/createElement(\"span\", {\n      key: index,\n      \"data-reach-combobox-option-text\": \"\",\n      \"data-user-value\": result.highlight ? true : undefined,\n      \"data-suggested-value\": result.highlight ? undefined : true\n    }, str);\n  }) : value);\n}\n\nif (process.env.NODE_ENV !== \"production\") {\n  ComboboxOptionText.displayName = \"ComboboxOptionText\";\n} ////////////////////////////////////////////////////////////////////////////////\n\n/**\n * ComboboxButton\n */\n\n\nvar ComboboxButton = /*#__PURE__*/forwardRef(function ComboboxButton(_ref6, forwardedRef) {\n  var _ref6$as = _ref6.as,\n      Comp = _ref6$as === void 0 ? \"button\" : _ref6$as,\n      onClick = _ref6.onClick,\n      onKeyDown = _ref6.onKeyDown,\n      props = _objectWithoutPropertiesLoose(_ref6, [\"as\", \"onClick\", \"onKeyDown\"]);\n\n  var _React$useContext7 = useContext(ComboboxContext),\n      transition = _React$useContext7.transition,\n      state = _React$useContext7.state,\n      buttonRef = _React$useContext7.buttonRef,\n      listboxId = _React$useContext7.listboxId,\n      isExpanded = _React$useContext7.isExpanded;\n\n  var ref = useComposedRefs(buttonRef, forwardedRef);\n  var handleKeyDown = useKeyDown();\n\n  var handleClick = function handleClick() {\n    if (state === IDLE) {\n      transition(OPEN_WITH_BUTTON);\n    } else {\n      transition(CLOSE_WITH_BUTTON);\n    }\n  };\n\n  return /*#__PURE__*/createElement(Comp, _extends({\n    \"aria-controls\": listboxId,\n    \"aria-haspopup\": \"listbox\",\n    \"aria-expanded\": isExpanded\n  }, props, {\n    \"data-reach-combobox-button\": \"\",\n    ref: ref,\n    onClick: composeEventHandlers(onClick, handleClick),\n    onKeyDown: composeEventHandlers(onKeyDown, handleKeyDown)\n  }));\n});\n\nif (process.env.NODE_ENV !== \"production\") {\n  ComboboxButton.displayName = \"ComboboxButton\";\n} ////////////////////////////////////////////////////////////////////////////////\n\n/**\n * Move focus back to the input if we start navigating w/ the\n * keyboard after focus has moved to any focusable content in\n * the popup.\n *\n * @param lastEventType\n * @param inputRef\n */\n\n\nfunction useFocusManagement(lastEventType, inputRef) {\n  // useLayoutEffect so that the cursor goes to the end of the input instead\n  // of awkwardly at the beginning, unclear to me why ü§∑‚Äç‚ôÇÔ∏è\n  //\n  // Should be safe to use here since we're just focusing an input.\n  useIsomorphicLayoutEffect(function () {\n    if (lastEventType === NAVIGATE || lastEventType === ESCAPE || lastEventType === SELECT_WITH_CLICK || lastEventType === OPEN_WITH_BUTTON) {\n      inputRef.current.focus();\n    }\n  }, [inputRef, lastEventType]);\n}\n/**\n * We want the same events when the input or the popup have focus (HOW COOL ARE\n * HOOKS BTW?) This is probably the hairiest piece but it's not bad.\n */\n\n\nfunction useKeyDown() {\n  var _React$useContext8 = useContext(ComboboxContext),\n      navigationValue = _React$useContext8.data.navigationValue,\n      onSelect = _React$useContext8.onSelect,\n      state = _React$useContext8.state,\n      transition = _React$useContext8.transition,\n      autocompletePropRef = _React$useContext8.autocompletePropRef,\n      persistSelectionRef = _React$useContext8.persistSelectionRef;\n\n  var options = useDescendants(ComboboxDescendantContext);\n  return function handleKeyDown(event) {\n    var index = options.findIndex(function (_ref7) {\n      var value = _ref7.value;\n      return value === navigationValue;\n    });\n\n    function getNextOption() {\n      var atBottom = index === options.length - 1;\n\n      if (atBottom) {\n        if (autocompletePropRef.current) {\n          // Go back to the value the user has typed because we are\n          // autocompleting and they need to be able to get back to what\n          // they had typed w/o having to backspace out.\n          return null;\n        } else {\n          // cycle through\n          return getFirstOption();\n        }\n      } else {\n        // Go to the next item in the list\n        return options[(index + 1) % options.length];\n      }\n    }\n\n    function getPreviousOption() {\n      var atTop = index === 0;\n\n      if (atTop) {\n        if (autocompletePropRef.current) {\n          // Go back to the value the user has typed because we are\n          // autocompleting and they need to be able to get back to what\n          // they had typed w/o having to backspace out.\n          return null;\n        } else {\n          // cycle through\n          return getLastOption();\n        }\n      } else if (index === -1) {\n        // displaying the user's value, so go select the last one\n        return getLastOption();\n      } else {\n        // normal case, select previous\n        return options[(index - 1 + options.length) % options.length];\n      }\n    }\n\n    function getFirstOption() {\n      return options[0];\n    }\n\n    function getLastOption() {\n      return options[options.length - 1];\n    }\n\n    switch (event.key) {\n      case \"ArrowDown\":\n        // Don't scroll the page\n        event.preventDefault();\n\n        if (!options || !options.length) {\n          return;\n        }\n\n        if (state === IDLE) {\n          // Opening a closed list\n          transition(NAVIGATE, {\n            persistSelection: persistSelectionRef.current\n          });\n        } else {\n          var next = getNextOption();\n          transition(NAVIGATE, {\n            value: next ? next.value : null\n          });\n        }\n\n        break;\n      // A lot of duplicate code with ArrowDown up next, I'm already over it.\n\n      case \"ArrowUp\":\n        // Don't scroll the page\n        event.preventDefault();\n\n        if (!options || options.length === 0) {\n          return;\n        }\n\n        if (state === IDLE) {\n          transition(NAVIGATE);\n        } else {\n          var prev = getPreviousOption();\n          transition(NAVIGATE, {\n            value: prev ? prev.value : null\n          });\n        }\n\n        break;\n\n      case \"Home\":\n      case \"PageUp\":\n        // Don't scroll the page\n        event.preventDefault();\n\n        if (!options || options.length === 0) {\n          return;\n        }\n\n        if (state === IDLE) {\n          transition(NAVIGATE);\n        } else {\n          transition(NAVIGATE, {\n            value: getFirstOption().value\n          });\n        }\n\n        break;\n\n      case \"End\":\n      case \"PageDown\":\n        // Don't scroll the page\n        event.preventDefault();\n\n        if (!options || options.length === 0) {\n          return;\n        }\n\n        if (state === IDLE) {\n          transition(NAVIGATE);\n        } else {\n          transition(NAVIGATE, {\n            value: getLastOption().value\n          });\n        }\n\n        break;\n\n      case \"Escape\":\n        if (state !== IDLE) {\n          transition(ESCAPE);\n        }\n\n        break;\n\n      case \"Enter\":\n        if (state === NAVIGATING && navigationValue !== null) {\n          // don't want to submit forms\n          event.preventDefault();\n          onSelect && onSelect(navigationValue);\n          transition(SELECT_WITH_KEYBOARD);\n        }\n\n        break;\n    }\n  };\n}\n\nfunction useBlur() {\n  var _React$useContext9 = useContext(ComboboxContext),\n      state = _React$useContext9.state,\n      transition = _React$useContext9.transition,\n      popoverRef = _React$useContext9.popoverRef,\n      inputRef = _React$useContext9.inputRef,\n      buttonRef = _React$useContext9.buttonRef;\n\n  var rafIds = useLazyRef(function () {\n    return new Set();\n  });\n  useEffect(function () {\n    return function () {\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n      rafIds.current.forEach(function (id) {\n        return cancelAnimationFrame(id);\n      });\n    };\n  }, [rafIds]);\n  return function handleBlur() {\n    var ownerDocument = getOwnerDocument(popoverRef.current);\n\n    if (!ownerDocument) {\n      return;\n    }\n\n    var rafId = requestAnimationFrame(function () {\n      // we on want to close only if focus propss outside the combobox\n      if (ownerDocument.activeElement !== inputRef.current && ownerDocument.activeElement !== buttonRef.current && popoverRef.current) {\n        if (popoverRef.current.contains(ownerDocument.activeElement)) {\n          // focus landed inside the combobox, keep it open\n          if (state !== INTERACTING) {\n            transition(INTERACT);\n          }\n        } else {\n          // focus landed outside the combobox, close it.\n          transition(BLUR);\n        }\n      }\n    });\n    rafIds.current.add(rafId);\n  };\n}\n/**\n * This manages transitions between states with a built in reducer to manage\n * the data that goes with those transitions.\n *\n * @param chart\n * @param reducer\n * @param initialData\n */\n\n\nfunction useReducerMachine(chart, reducer, initialData) {\n  var _React$useState = useState(chart.initial),\n      state = _React$useState[0],\n      setState = _React$useState[1];\n\n  var _React$useReducer = useReducer(reducer, initialData),\n      data = _React$useReducer[0],\n      dispatch = _React$useReducer[1];\n\n  var transition = function transition(event, payload) {\n    if (payload === void 0) {\n      payload = {};\n    }\n\n    var currentState = chart.states[state];\n    var nextState = currentState && currentState.on[event];\n\n    if (nextState) {\n      dispatch(_extends({\n        type: event,\n        state: state,\n        nextState: state\n      }, payload));\n      setState(nextState);\n      return;\n    }\n  };\n\n  return [state, data, transition];\n}\n/**\n * We don't want to track the active descendant with indexes because nothing is\n * more annoying in a combobox than having it change values RIGHT AS YOU HIT\n * ENTER. That only happens if you use the index as your data, rather than\n * *your data as your data*. We use this to generate a unique ID based on the\n * value of each item.  This function is short, sweet, and good enough‚Ñ¢ (I also\n * don't know how it works, tbqh)\n *\n * @see https://stackoverflow.com/questions/6122571/simple-non-secure-hash-function-for-javascript\n * @param str\n */\n\n\nfunction makeHash(str) {\n  var hash = 0;\n\n  if (str.length === 0) {\n    return hash;\n  }\n\n  for (var i = 0; i < str.length; i++) {\n    var _char = str.charCodeAt(i);\n\n    hash = (hash << 5) - hash + _char;\n    hash = hash & hash;\n  }\n\n  return hash;\n}\n\nfunction getDataState(state) {\n  return state.toLowerCase();\n}\n/**\n * Escape regexp special characters in `str`\n *\n * @see https://github.com/component/escape-regexp/blob/5ce923c1510c9802b3da972c90b6861dd2829b6b/index.js\n * @param str\n */\n\n\nfunction escapeRegexp(str) {\n  return String(str).replace(/([.*+?=^!:${}()|[\\]/\\\\])/g, \"\\\\$1\");\n} //////////////////////////\n//////////////////////////////////////////////////////\n\n/**\n * A hook that exposes data for a given `Combobox` component to its descendants.\n *\n * @see Docs https://reach.tech/combobox#usecomboboxcontext\n */\n\nfunction useComboboxContext() {\n  var _React$useContext10 = useContext(ComboboxContext),\n      isExpanded = _React$useContext10.isExpanded,\n      comboboxId = _React$useContext10.comboboxId,\n      data = _React$useContext10.data,\n      state = _React$useContext10.state;\n\n  var navigationValue = data.navigationValue;\n  return useMemo(function () {\n    return {\n      id: comboboxId,\n      isExpanded: isExpanded,\n      navigationValue: navigationValue != null ? navigationValue : null,\n      state: state\n    };\n  }, [comboboxId, isExpanded, navigationValue, state]);\n}\n/**\n * A hook that exposes data for a given `ComboboxOption` component to its descendants.\n *\n * @see Docs https://reach.tech/combobox#usecomboboxcontext\n */\n\nfunction useComboboxOptionContext() {\n  var _React$useContext11 = useContext(OptionContext),\n      value = _React$useContext11.value,\n      index = _React$useContext11.index;\n\n  return useMemo(function () {\n    return {\n      value: value,\n      index: index\n    };\n  }, [value, index]);\n} ////////////////////////////////////////////////////////////////////////////////\n// Well alright, you made it all the way here to like 1100 lines of code (geez,\n// what the heck?). Have a great day :D\n////////////////////////////////////////////////////////////////////////////////\n// Types\n\nexport { Combobox, ComboboxButton, ComboboxInput, ComboboxList, ComboboxOption, ComboboxOptionText, ComboboxPopover, escapeRegexp, useComboboxContext, useComboboxOptionContext };\n"]},"metadata":{},"sourceType":"module"}